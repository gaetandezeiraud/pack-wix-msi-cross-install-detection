<?xml version="1.0" encoding="utf-8"?>
<CPackWiXPatch>
	<CPackWiXFragment Id="#PRODUCTFEATURE">
		<!-- App always installs; FolderA/B controlled by conditions -->
		<Feature Id="App" Level="1" />
		<Feature Id="FolderA" Level="1000" />
		<Feature Id="FolderB" Level="1" />
	</CPackWiXFragment>
	<CPackWiXFragment Id="#PRODUCT">
		<!-- Define default behavior: FolderA=yes, FolderB=no -->
		<Property Id="DEFAULT_FOLDERA" Value="0" />
		<Property Id="DEFAULT_FOLDERB" Value="1" />
		<!-- Detect folders via marker.txt -->
		<Property Id="FOLDERB_EXISTS">
			<DirectorySearch Id="CheckFolderA" Path="[INSTALLDIR]Data\FolderA">
				<FileSearch Id="CheckFolderAFile" Name="marker.txt" />
			</DirectorySearch>
		</Property>
		<!-- Upgrade: Detect lower-version related products -->
		<Upgrade Id="$(var.CPACK_WIX_UPGRADE_GUID)">
			<UpgradeVersion Minimum="$(var.CPACK_PACKAGE_VERSION)" IncludeMinimum="no" OnlyDetect="no" Property="PREVIOUSVERSIONSINSTALLED" />
		</Upgrade>
	</CPackWiXFragment>
</CPackWiXPatch>